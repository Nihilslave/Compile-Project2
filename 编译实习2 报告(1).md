## 编译大作业2 报告

> 分工：
>
> 自动求导技术设计：刘易鑫，周迈，杨扬
>
> 具体实现：周迈

**总体实现思路是先设计梯度树，再利用 project1 翻译成 c 代码**

#### 1.梯度树设计

梯度树是在 project1 得到的语法树的基础上修改的。我们的工作就是对这个语法树的每个 Expr 类的叶子结点求出其梯度公式。知道了根部节点的梯度后，就能根据链式法则将根结点的梯度流传到每个叶子结点。对整颗语法树进行深度优先搜索，visit 每个结点的时候，为其各个儿子结点求得梯度（如果有的话），然后自顶向下递归。

对 Expr 类的处理按照以下的梯度公式处理，这也是整个算法的核心。

**梯度公式**
$$
ExprC = ExprA → dA = dC
$$

$$
ExprC = ExprA + ExprB → dA = dC，dB = + dC
$$

$$
ExprC = ExprA - ExprB → dA = dC，dB = - dC
$$

$$
ExprC = ExprA * ExprB → dA = dC * B，dB = dC * A
$$

$$
 Expr C = Expr A / Expr B  → dA = dC / B ，dB = - dC * A / (B * B)
$$

**下标处理**

观察求导过程归纳可得，下标不需做处理，保留即可。

#### 2.代码翻译

梯度树生成之后，只用调用第一次 project 的 IRPrinter 即可翻译

注意点：



#### 3.具体实现



#### 4.举例



#### 5.目前的不足